# Main site - fixed with working health check
server {
    listen 80 default_server;
    listen [::]:80 default_server;
    server_name honeybun.local;
    
    # Disable redirects
    absolute_redirect off;
    port_in_redirect off;
    
    # Health check works now - don't change it
    location = /health {
        add_header Content-Type text/plain;
        return 200 "OK";
    }
    
    # Root directory path
    root /var/www/html/honeybun;
    
    # Fix for the root path
    location = / {
        # First try to serve the index file if it exists
        try_files /index.html @root_fallback;
    }
    
    # Fallback for root when index.html doesn't exist
    location @root_fallback {
        add_header Content-Type text/html;
        return 200 "<html><body><h1>Welcome to Honeybun</h1><p>Your Nginx proxy is working!</p></body></html>";
    }
    
    # Other locations
    location / {
        try_files $uri @error_handler;
    }
    
    # Error handler
    location @error_handler {
        add_header Content-Type text/html;
        return 404 "<html><body><h1>Not Found</h1><p>The requested page could not be found.</p></body></html>";
    }
}